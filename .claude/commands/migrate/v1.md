---
description: V1 ì—”ë“œí¬ì¸íŠ¸ êµ¬í˜„ (ë ˆê±°ì‹œ 100% í˜¸í™˜). Controller, Response DTO, Mapper ìƒì„±.
tags: [project]
---

# /migrate:v1 - Implement V1 Endpoints

ë ˆê±°ì‹œì™€ 100% í˜¸í™˜ë˜ëŠ” V1 ì—”ë“œí¬ì¸íŠ¸ë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤.

## ì…ë ¥

```bash
/migrate:v1 {domain}

# ì˜ˆì‹œ
/migrate:v1 product
/migrate:v1 order
/migrate:v1 user
```

## êµ¬í˜„ í”„ë¡œì„¸ìŠ¤

```
/migrate:v1 {domain}
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1ï¸âƒ£ Serena Memory ì½ê¸°                           â”‚
â”‚    - read_memory("v1-api-pattern")              â”‚
â”‚    - read_memory("migration-status")            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2ï¸âƒ£ ë ˆê±°ì‹œ ë¶„ì„                                   â”‚
â”‚    - Controller ì—”ë“œí¬ì¸íŠ¸ ëª©ë¡                   â”‚
â”‚    - Response DTO í•„ë“œ êµ¬ì¡°                      â”‚
â”‚    - ìš”ì²­ íŒŒë¼ë¯¸í„°                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3ï¸âƒ£ ê³ ë„í™”ëœ UseCase í™•ì¸                         â”‚
â”‚    - application ëª¨ë“ˆì˜ port/in/query|command   â”‚
â”‚    - í˜¸ì¶œ ê°€ëŠ¥í•œ UseCase ì‹ë³„                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4ï¸âƒ£ V1 ì»´í¬ë„ŒíŠ¸ ìƒì„±                              â”‚
â”‚    - {Domain}V1Controller.java                  â”‚
â”‚    - {Domain}V1ApiResponse.java                 â”‚
â”‚    - {Domain}V1ApiMapper.java                   â”‚
â”‚    - {Domain}V1SearchApiRequest.java (í•„ìš”ì‹œ)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5ï¸âƒ£ migration-status ì—…ë°ì´íŠ¸                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ìƒì„± íŒŒì¼ êµ¬ì¡°

### Customer API (adapter-in/rest-api)

```
src/main/java/com/ryuqq/setof/adapter/in/rest/
â””â”€â”€ v1/{domain}/
    â”œâ”€â”€ controller/
    â”‚   â””â”€â”€ {Domain}V1Controller.java
    â”œâ”€â”€ dto/
    â”‚   â”œâ”€â”€ query/
    â”‚   â”‚   â””â”€â”€ {Domain}V1SearchApiRequest.java
    â”‚   â””â”€â”€ response/
    â”‚       â””â”€â”€ {Domain}V1ApiResponse.java
    â””â”€â”€ mapper/
        â””â”€â”€ {Domain}V1ApiMapper.java
```

### Admin API (adapter-in/rest-api-admin)

```
src/main/java/com/ryuqq/setof/adapter/in/rest/admin/
â””â”€â”€ v1/{domain}/
    â”œâ”€â”€ controller/
    â”‚   â””â”€â”€ {Domain}AdminV1Controller.java
    â”œâ”€â”€ dto/
    â”‚   â””â”€â”€ response/
    â”‚       â””â”€â”€ {Domain}AdminV1ApiResponse.java
    â””â”€â”€ mapper/
        â””â”€â”€ {Domain}AdminV1ApiMapper.java
```

## V1 Controller í…œí”Œë¦¿

```java
package com.ryuqq.setof.adapter.in.rest.v1.{domain}.controller;

import com.ryuqq.setof.adapter.in.rest.auth.paths.ApiPaths;
import com.ryuqq.setof.adapter.in.rest.common.v1.dto.V1ApiResponse;
import com.ryuqq.setof.adapter.in.rest.v1.{domain}.dto.response.{Domain}V1ApiResponse;
import com.ryuqq.setof.adapter.in.rest.v1.{domain}.mapper.{Domain}V1ApiMapper;
import com.ryuqq.setof.application.{domain}.port.in.query.Get{Domain}UseCase;
import io.swagger.v3.oas.annotations.Operation;
import io.swagger.v3.oas.annotations.tags.Tag;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

@Tag(name = "{Domain} (Legacy V1)", description = "ë ˆê±°ì‹œ {Domain} API - V2ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜ ê¶Œì¥")
@Deprecated
@RestController
@RequestMapping
public class {Domain}V1Controller {

    private final Get{Domain}UseCase get{Domain}UseCase;
    private final {Domain}V1ApiMapper mapper;

    public {Domain}V1Controller(
            Get{Domain}UseCase get{Domain}UseCase,
            {Domain}V1ApiMapper mapper) {
        this.get{Domain}UseCase = get{Domain}UseCase;
        this.mapper = mapper;
    }

    @Deprecated
    @Operation(
            summary = "[Legacy] {Domain} ì¡°íšŒ",
            description = """
                    **âš ï¸ Deprecated**: V2 API ì‚¬ìš©ì„ ê¶Œì¥í•©ë‹ˆë‹¤.
                    - V2 ì—”ë“œí¬ì¸íŠ¸: `GET /api/v2/{domains}/{id}`

                    **ğŸ”“ ê¶Œí•œ**: Public (ì¸ì¦ ë¶ˆí•„ìš”)
                    """)
    @GetMapping(ApiPaths.{Domain}.DETAIL)
    public ResponseEntity<V1ApiResponse<{Domain}V1ApiResponse>> get{Domain}(
            @PathVariable("{domain}Id") long id) {
        var response = get{Domain}UseCase.execute(id);
        var v1Response = mapper.toV1Response(response);
        return ResponseEntity.ok(V1ApiResponse.success(v1Response));
    }
}
```

## V1 Response DTO í…œí”Œë¦¿

```java
package com.ryuqq.setof.adapter.in.rest.v1.{domain}.dto.response;

import io.swagger.v3.oas.annotations.media.Schema;

@Schema(description = "{Domain} ì‘ë‹µ")
public record {Domain}V1ApiResponse(
        // ë ˆê±°ì‹œì™€ ë™ì¼í•œ í•„ë“œëª… ì‚¬ìš©
        @Schema(description = "{Domain} ID") Long {domain}Id,
        @Schema(description = "ì´ë¦„") String {domain}Name
        // ... ë ˆê±°ì‹œ DTO í•„ë“œ ë³µì‚¬
) {}
```

## V1 Mapper í…œí”Œë¦¿

```java
package com.ryuqq.setof.adapter.in.rest.v1.{domain}.mapper;

import com.ryuqq.setof.adapter.in.rest.v1.{domain}.dto.response.{Domain}V1ApiResponse;
import com.ryuqq.setof.application.{domain}.dto.response.{Domain}Response;
import org.springframework.stereotype.Component;

@Component
public class {Domain}V1ApiMapper {

    public {Domain}V1ApiResponse toV1Response({Domain}Response response) {
        return new {Domain}V1ApiResponse(
                response.id(),
                response.name()
                // ... í•„ë“œ ë§¤í•‘
        );
    }
}
```

## í•µì‹¬ ì›ì¹™

### 1. ë ˆê±°ì‹œ 100% í˜¸í™˜

- URL ê²½ë¡œ ë™ì¼
- ìš”ì²­ íŒŒë¼ë¯¸í„° ë™ì¼
- ì‘ë‹µ í•„ë“œëª… ë™ì¼
- ì‘ë‹µ ë˜í¼ êµ¬ì¡° ë™ì¼ (V1ApiResponse)

### 2. ê³ ë„í™”ëœ UseCase ì‚¬ìš©

```
Legacy: LegacyService.findAll()
   â†“ ëŒ€ì²´
V1 New: GetXxxUseCase.execute() â†’ V1Mapper â†’ V1Response
```

### 3. OpenAPI ì–´ë…¸í…Œì´ì…˜ í•„ìˆ˜

- `@Tag`: Legacy V1 í‘œì‹œ
- `@Deprecated`: í´ë˜ìŠ¤ + ë©”ì„œë“œ ë ˆë²¨
- `@Operation`: [Legacy] ì ‘ë‘ì‚¬
- `@Schema`: ëª¨ë“  í•„ë“œ ë¬¸ì„œí™”

## ê´€ë ¨ ì»¤ë§¨ë“œ

- `/migrate:analyze {domain}` - ë¶„ì„ ë¨¼ì € ì‹¤í–‰ ê¶Œì¥
- `/migrate:docs {domain}` - êµ¬í˜„ í›„ ë¬¸ì„œí™”
- `/migrate:status` - ì „ì²´ ì§„í–‰ í˜„í™©
