#!/bin/bash
# ========================================
# Post-Commit Hook Wrapper
# ========================================
# Calls track-tdd-cycle.sh for LangFuse tracking
# ========================================

set -e

# Project root 찾기
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_ROOT="$(cd "$SCRIPT_DIR/../.." && pwd)"

cd "$PROJECT_ROOT"

# TDD Cycle 추적 스크립트 실행
TDD_TRACKER=".claude/hooks/track-tdd-cycle.sh"

if [[ -f "$TDD_TRACKER" ]]; then
    if bash "$TDD_TRACKER"; then
        exit 0
    else
        # 실패해도 커밋은 계속 진행 (non-blocking)
        echo "⚠️  TDD tracking failed (non-blocking)"
        exit 0
    fi
else
    echo "⚠️  TDD tracker not found: $TDD_TRACKER"
    exit 0
fi
